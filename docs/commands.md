# Команды

Данный документ описывает поддерживаемые типы команд и ответов на них.
Указанные команды передаются в теле Data Request и Data Response для запросов и ответов соответственно.

Эти же команды будут сериализованы в лог.

# Запросы

## Enqueue

Запрос на добавления записи в требуемую очередь.
Поле "Ключ" указывается в виде Int64 значения.
Поле "Данные" имеет длину указанную в поле "Длина"

Формат:

| Маркер | Очередь | Ключ  | Данные |
|--------|---------|-------|--------|
| 'E'    | String  | Int64 | Buffer |

## Dequeue

Запрос на получение записи из очереди.

Формат:

| Маркер | Очередь |
|--------|---------|
| 'D'    | String  |

## Count

Получить количество записей в очереди 

Формат:

| Маркер | Очередь |
|--------|---------|
| 'C'    | String  |

# Ответы

## Enqueue

Возвращает ответ на запрос 'Enqueue'

Успех: 1 - значение добавлено в очередь, 0 - не добавлено

Формат:

| Маркер | Успех |
|--------|-------|
| 'e'    | Byte  |

## Dequeue

Ответ на запрос 'Dequeue'.
Если из очереди получилось получить данные, то в поле Success будет выставлено 1, в противном случае 0.
В зависимости от того, получилось ли извлечь данные (поле Success) будут выставлены остальные поля.
Если значение было получено, то остальные поля представлены, иначе дальше не будет данных

Формат:

| Маркер | Успех | Ключ  | Данные |
|--------|-------|-------|--------|
| 'd'    | Byte  | Int64 | Buffer |

Если данные присутствуют:

| Маркер | Успех   | Ключ  | Данные |
|--------|---------|-------|--------|
| 'd'    | Byte(1) | Int64 | Buffer |

Если данные отсутствуют:

| Маркер | Успех   |
|--------|---------|
| 'd'    | Byte(0) | 

## Count

Ответ на Count запрос

Формат:

| Маркер | Количество |
|--------|------------|
| 'c'    | Int32      |

## Error

Ответ посылаемый в случае возникновения ошибки во время исполнения команды.
Возникаемые ошибки относятся к бизнес-логике, а не самому приложению.

Примеры ошибок:
- Неправильное название очереди
- Очередь достигла максимального размера
- Очереди с указанным названием не существует

Поля:
- Subtype - маркерный байт указывающий на подтип ошибки
- Message - сообщение об ошибке

Формат:

| Маркер | Тип ошибки | Сообщение |
|--------|------------|-----------|
| 'E'    | Byte       | String    |

Типы ошибок:

| Маркер | Описание                                                    |
|--------|-------------------------------------------------------------|
| 0      | Неизвестная ошибка бизнес-логики                            |
| 1      | Указанное название очереди представляет невалидное значение |
| 2      | Очереди с указанным названием не существует                 |

