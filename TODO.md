# Лист работ

Что хочу сделать?

## Баг с подключением узлов

Описание: при подключении узлов сейчас есть вероятность отправки ConnectResponse вместо AppendEntries или другое

Проблема решена так:

- Код логики tcp адаптера (реального) отрефакторил, там теперь немного чище
- Скорее всего проблема была из-за состояния гонки, поэтому просто сделал декоратор с `lock` - это ок, т.к. все вызовы
  синхронные
- Чтобы более гранулярно отслеживать токен отмены - в ожидании при потере соединения регистрирую cb на отмену токена где
  вызываю `Thread.Interrupt`

Еще:

- Отслеживать токен жизни состояния - прекращать отправку, если токен был отменен

## ID для записей

Описание: каждой записи назначать собственный ID для упрощения работы

Дополнительно:

- Можно использовать `ulong`
- Учитывать при восстановлении, вставке/удалении
- Скорее всего эту логику передать в объект очереди (хранит там что-то типа счетчика, а может и Guid рандомный)

## Блокирующее чтение

Самое важное (мечта)

Описание: необходимо иметь функциональность блокирующих чтений - с таймаутом (вместо активного опроса)
